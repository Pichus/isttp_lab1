@startuml Student_Parliament_ERD
title ER Diagram: SPF Event & Coworking System
hide circle
skinparam linetype ortho

' --- STYLING ---
skinparam class {
    BackgroundColor White
    ArrowColor #2C3E50
    BorderColor #2C3E50
}

' --- USERS & ACCESS ---

entity "User" as user {
  *id : UUID <<PK>>
  --
  name : VARCHAR(100)
  email : VARCHAR(100)
  password_hash : VARCHAR(255)
  created_at : TIMESTAMP
}

entity "Role" as role {
  *id : UUID <<PK>>
  --
  name : VARCHAR(50)
}

entity "UserRole" as user_role {
  *user_id : UUID <<PK, FK>>
  *role_id : UUID <<PK, FK>>
}

' --- DEPARTMENTS ---

entity "Department" as department {
  *id : UUID <<PK>>
  --
  name : VARCHAR(50)
  description : TEXT
}

entity "DepartmentRole" as dept_role {
  *id : UUID <<PK>>
  --
  name : VARCHAR(50) 
  ' e.g. Member, Deputy, SMM, etc.
}

entity "DepartmentMember" as dept_member {
  *user_id : UUID <<PK, FK>>
  *department_id : UUID <<PK, FK>>
  --
  *department_role_id : UUID <<FK>>
  joined_at : TIMESTAMP
}

' --- EVENTS ---

entity "Event" as event {
  *id : UUID <<PK>>
  --
  title : VARCHAR(200)
  description : TEXT
  poster_url : VARCHAR(255)
  location : VARCHAR(255)
  max_participants : INT
  is_published : BOOLEAN
  --
  *created_by_user_id : UUID <<FK>>
  created_at : TIMESTAMP
}

entity "EventTag" as tag {
  *id : UUID <<PK>>
  --
  name : VARCHAR(50)
}

entity "EventTagMap" as event_tag_map {
  *event_id : UUID <<PK, FK>>
  *tag_id : UUID <<PK, FK>>
}

entity "EventRegistration" as registration {
  *id : UUID <<PK>>
  --
  *user_id : UUID <<FK>>
  *event_id : UUID <<FK>>
  registered_at : TIMESTAMP
}

' --- EVENT ORGANIZATION ---

entity "EventOrganizer" as organizer {
  *id : UUID <<PK>>
  --
  *event_id : UUID <<FK>>
  *user_id : UUID <<FK>>
  role_description : VARCHAR(100)
}

entity "OrgRequestStatus" as org_status {
  *id : UUID <<PK>>
  --
  name : VARCHAR(50)
  ' e.g. Pending, Approved, Rejected
}

entity "OrgRequest" as org_request {
  *id : UUID <<PK>>
  --
  *user_id : UUID <<FK>>
  *event_id : UUID <<FK>>
  *status_id : UUID <<FK>>
  created_at : TIMESTAMP
}

' --- COWORKING ---

entity "BookingStatus" as booking_status {
  *id : UUID <<PK>>
  --
  name : VARCHAR(50)
  ' e.g. Pending, Confirmed, Cancelled
}

entity "CoworkingBooking" as booking {
  *id : UUID <<PK>>
  --
  *event_id : UUID <<FK>>
  *status_id : UUID <<FK>>
  space_manager_id : UUID <<FK>>
  --
  start_time : TIMESTAMP
  end_time : TIMESTAMP
  notes : TEXT
}

' --- RELATIONSHIPS ---

' User Roles
user ||..o{ user_role
role ||..o{ user_role

' Departments
user ||..o{ dept_member
department ||..o{ dept_member
dept_role ||..o{ dept_member
department |o..|| user : "headed by"

' Event Basic
user ||..o{ event : "creates"
event ||..o{ event_tag_map
tag ||..o{ event_tag_map

' Registration
user ||..o{ registration
event ||..o{ registration

' Organization Team
user ||..o{ organizer
event ||..o{ organizer

' Organization Requests
user ||..o{ org_request : "requests to join"
event ||..o{ org_request
org_status ||..o{ org_request

' Coworking
event ||..o{ booking : "has booking"
booking_status ||..o{ booking
user |o..o{ booking : "manager approves"

@enduml